var e,n,t=function(){function e(){this.events=void 0,this.events={}}var n=e.prototype;return n.emit=function(e,n){return this.events[e]&&this.events[e].forEach(function(e){return e(n)}),this},n.on=function(e,n){return this.events[e]?this.events[e].push(n):this.events[e]=[n],this},n.off=function(e,n){if(e&&"function"==typeof n){var t=this.events[e],r=t.findIndex(function(e){return e===n});t.splice(r,1)}else this.events[e]=[];return this},e}();function r(e,n){return r=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},r(e,n)}exports.RequestFunc=void 0,(e=exports.RequestFunc||(exports.RequestFunc={})).INITSDK="InitSDK",e.LOGIN="Login",e.LOGOUT="Logout",e.GETLOGINSTATUS="GetLoginStatus",e.GETLOGINUSER="GetLoginUser",e.GETSELFUSERINFO="GetSelfUserInfo",e.CREATETEXTMESSAGE="CreateTextMessage",e.CREATETEXTATMESSAGE="CreateTextAtMessage",e.CREATEIMAGEMESSAGEFROMBYURL="CreateImageMessageByURL",e.CREATESOUNDMESSAGEBYURL="CreateSoundMessageByURL",e.CREATEVIDEOMESSAGEBYURL="CreateVideoMessageByURL",e.CREATEFILEMESSAGEBYURL="CreateFileMessageByURL",e.CREATEIMAGEMESSAGEFROMFULLPATH="CreateImageMessageFromFullPath",e.CREATESOUNDMESSAGEFROMFULLPATH="CreateSoundMessageFromFullPath",e.CREATEVIDEOMESSAGEFROMFULLPATH="CreateVideoMessageFromFullPath",e.CREATEFILEMESSAGEFROMFULLPATH="CreateFileMessageFromFullPath",e.CREATELOCATIONMESSAGE="CreateLocationMessage",e.CREATECUSTOMMESSAGE="CreateCustomMessage",e.CREATEMERGERMESSAGE="CreateMergerMessage",e.CREATEFORWARDMESSAGE="CreateForwardMessage",e.CREATEQUOTEMESSAGE="CreateQuoteMessage",e.CREATECARDMESSAGE="CreateCardMessage",e.CREATEFACEMESSAGE="CreateFaceMessage",e.SENDMESSAGE="SendMessage",e.SENDMESSAGENOTOSS="SendMessageNotOss",e.GETHISTORYMESSAGELIST="GetHistoryMessageList",e.REVOKEMESSAGE="RevokeMessage",e.SETONECONVERSATIONPRIVATECHAT="SetOneConversationPrivateChat",e.DELETEMESSAGEFROMLOCALSTORAGE="DeleteMessageFromLocalStorage",e.DELETEMESSAGEFROMLOCALANDSVR="DeleteMessageFromLocalAndSvr",e.DELETECONVERSATIONFROMLOCALANDSVR="DeleteConversationFromLocalAndSvr",e.DELETEALLMSGFROMLOCALANDSVR="DeleteAllMsgFromLocalAndSvr",e.DELETEALLMSGFROMLOCAL="DeleteAllMsgFromLocal",e.MARKSINGLEMESSAGEHASREAD="MarkSingleMessageHasRead",e.INSERTSINGLEMESSAGETOLOCALSTORAGE="InsertSingleMessageToLocalStorage",e.INSERTGROUPMESSAGETOLOCALSTORAGE="InsertGroupMessageToLocalStorage",e.TYPINGSTATUSUPDATE="TypingStatusUpdate",e.MARKC2CMESSAGEASREAD="MarkC2CMessageAsRead",e.MARKMESSAGEASREADBYCONID="MarkMessageAsReadByConID",e.CLEARC2CHISTORYMESSAGE="ClearC2CHistoryMessage",e.CLEARGROUPHISTORYMESSAGE="ClearGroupHistoryMessage",e.ADDFRIEND="AddFriend",e.GETDESIGNATEDFRIENDSINFO="GetDesignatedFriendsInfo",e.GETRECVFRIENDAPPLICATIONLIST="GetRecvFriendApplicationList",e.GETSENDFRIENDAPPLICATIONLIST="GetSendFriendApplicationList",e.GETFRIENDLIST="GetFriendList",e.SETFRIENDREMARK="SetFriendRemark",e.ADDBLACK="AddBlack",e.GETBLACKLIST="GetBlackList",e.REMOVEBLACK="RemoveBlack",e.CHECKFRIEND="CheckFriend",e.ACCEPTFRIENDAPPLICATION="AcceptFriendApplication",e.REFUSEFRIENDAPPLICATION="RefuseFriendApplication",e.DELETEFRIEND="DeleteFriend",e.GETUSERSINFO="GetUsersInfo",e.SETSELFINFO="SetSelfInfo",e.GETALLCONVERSATIONLIST="GetAllConversationList",e.GETCONVERSATIONLISTSPLIT="GetConversationListSplit",e.GETONECONVERSATION="GetOneConversation",e.GETCONVERSATIONIDBYSESSIONTYPE="GetConversationIDBySessionType",e.GETMULTIPLECONVERSATION="GetMultipleConversation",e.DELETECONVERSATION="DeleteConversation",e.SETCONVERSATIONDRAFT="SetConversationDraft",e.PINCONVERSATION="PinConversation",e.GETTOTALUNREADMSGCOUNT="GetTotalUnreadMsgCount",e.GETCONVERSATIONRECVMESSAGEOPT="GetConversationRecvMessageOpt",e.SETCONVERSATIONRECVMESSAGEOPT="SetConversationRecvMessageOpt",e.SEARCHLOCALMESSAGES="SearchLocalMessages",e.MARKGROUPMESSAGEHASREAD="MarkGroupMessageHasRead",e.MARKGROUPMESSAGEASREAD="MarkGroupMessageAsRead",e.INVITEUSERTOGROUP="InviteUserToGroup",e.KICKGROUPMEMBER="KickGroupMember",e.GETGROUPMEMBERSINFO="GetGroupMembersInfo",e.GETGROUPMEMBERLIST="GetGroupMemberList",e.GETJOINEDGROUPLIST="GetJoinedGroupList",e.CREATEGROUP="CreateGroup",e.SETGROUPINFO="SetGroupInfo",e.GETGROUPSINFO="GetGroupsInfo",e.JOINGROUP="JoinGroup",e.QUITGROUP="QuitGroup",e.DISMISSGROUP="DismissGroup",e.CHANGEGROUPMUTE="ChangeGroupMute",e.CHANGEGROUPMEMBERMUTE="ChangeGroupMemberMute",e.TRANSFERGROUPOWNER="TransferGroupOwner",e.GETSENDGROUPAPPLICATIONLIST="GetSendGroupApplicationList",e.GETRECVGROUPAPPLICATIONLIST="GetRecvGroupApplicationList",e.ACCEPTGROUPAPPLICATION="AcceptGroupApplication",e.REFUSEGROUPAPPLICATION="RefuseGroupApplication",e.SIGNALINGINVITE="SignalingInvite",e.SIGNALINGINVITEINGROUP="SignalingInviteInGroup",e.SIGNALINGACCEPT="SignalingAccept",e.SIGNALINGREJECT="SignalingReject",e.SIGNALINGCANCEL="SignalingCancel",exports.CbEvents=void 0,(n=exports.CbEvents||(exports.CbEvents={})).ONCONNECTFAILED="OnConnectFailed",n.ONCONNECTSUCCESS="OnConnectSuccess",n.ONCONNECTING="OnConnecting",n.ONKICKEDOFFLINE="OnKickedOffline",n.ONSELFINFOUPDATED="OnSelfInfoUpdated",n.ONUSERTOKENEXPIRED="OnUserTokenExpired",n.ONPROGRESS="OnProgress",n.ONRECVNEWMESSAGE="OnRecvNewMessage",n.ONRECVMESSAGEREVOKED="OnRecvMessageRevoked",n.ONRECVC2CREADRECEIPT="OnRecvC2CReadReceipt",n.ONRECVGROUPREADRECEIPT="OnRecvGroupReadReceipt",n.ONCONVERSATIONCHANGED="OnConversationChanged",n.ONNEWCONVERSATION="OnNewConversation",n.ONSYNCSERVERFAILED="OnSyncServerFailed",n.ONSYNCSERVERFINISH="OnSyncServerFinish",n.ONSYNCSERVERSTART="OnSyncServerStart",n.ONTOTALUNREADMESSAGECOUNTCHANGED="OnTotalUnreadMessageCountChanged",n.ONBLACKADDED="OnBlackAdded",n.ONBLACKDELETED="OnBlackDeleted",n.ONFRIENDAPPLICATIONACCEPTED="OnFriendApplicationAccepted",n.ONFRIENDAPPLICATIONADDED="OnFriendApplicationAdded",n.ONFRIENDAPPLICATIONDELETED="OnFriendApplicationDeleted",n.ONFRIENDAPPLICATIONREJECTED="OnFriendApplicationRejected",n.ONFRIENDINFOCHANGED="OnFriendInfoChanged",n.ONFRIENDADDED="OnFriendAdded",n.ONFRIENDDELETED="OnFriendDeleted",n.ONJOINEDGROUPADDED="OnJoinedGroupAdded",n.ONJOINEDGROUPDELETED="OnJoinedGroupDeleted",n.ONGROUPMEMBERADDED="OnGroupMemberAdded",n.ONGROUPMEMBERDELETED="OnGroupMemberDeleted",n.ONGROUPAPPLICATIONADDED="OnGroupApplicationAdded",n.ONGROUPAPPLICATIONDELETED="OnGroupApplicationDeleted",n.ONGROUPINFOCHANGED="OnGroupInfoChanged",n.ONGROUPMEMBERINFOCHANGED="OnGroupMemberInfoChanged",n.ONGROUPAPPLICATIONACCEPTED="OnGroupApplicationAccepted",n.ONGROUPAPPLICATIONREJECTED="OnGroupApplicationRejected",n.ONRECEIVENEWINVITATION="OnReceiveNewInvitation",n.ONINVITEEACCEPTED="OnInviteeAccepted",n.ONINVITEEREJECTED="OnInviteeRejected",n.ONINVITATIONCANCELLED="OnInvitationCancelled",n.ONINVITATIONTIMEOUT="OnInvitationTimeout",n.ONINVITEEACCEPTEDBYOTHERDEVICE="OnInviteeAcceptedByOtherDevice",n.ONINVITEEREJECTEDBYOTHERDEVICE="OnInviteeRejectedByOtherDevice";var o=function(e){return(36*Math.random()).toString(36).slice(2)+(new Date).getTime().toString()+e};exports.OpenIMSDK=function(e){var n,t;function u(){var n;return(n=e.call(this)||this).ws=void 0,n.uid=void 0,n.token=void 0,n.platform="web",n.wsUrl="",n.lock=!1,n.logoutFlag=!1,n.ws2promise={},n.onceFlag=!0,n.getLoginStatus=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETLOGINSTATUS,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getLoginUser=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETLOGINUSER,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getSelfUserInfo=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETSELFUSERINFO,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getUsersInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETUSERSINFO,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.setSelfInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SETSELFINFO,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createTextMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATETEXTMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createTextAtMessage=function(e,t){return new Promise(function(r,u){var i=e;i.atUserIDList=JSON.stringify(i.atUserIDList);var s=t||o(n.uid),a={reqFuncName:exports.RequestFunc.CREATETEXTATMESSAGE,operationID:s,userID:n.uid,data:i};n.wsSend(a,r,u)})},n.createImageMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.bigPicture=JSON.stringify(s.bigPicture),s.snapshotPicture=JSON.stringify(s.snapshotPicture),s.sourcePicture=JSON.stringify(s.sourcePicture);var a={reqFuncName:exports.RequestFunc.CREATEIMAGEMESSAGEFROMBYURL,operationID:i,userID:n.uid,data:JSON.stringify(s)};n.wsSend(a,r,u)})},n.createSoundMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={soundBaseInfo:JSON.stringify(e)},a={reqFuncName:exports.RequestFunc.CREATESOUNDMESSAGEBYURL,operationID:i,userID:n.uid,data:JSON.stringify(s)};n.wsSend(a,r,u)})},n.createVideoMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={videoBaseInfo:JSON.stringify(e)},a={reqFuncName:exports.RequestFunc.CREATEVIDEOMESSAGEBYURL,operationID:i,userID:n.uid,data:JSON.stringify(s)};n.wsSend(a,r,u)})},n.createFileMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={fileBaseInfo:JSON.stringify(e)},a={reqFuncName:exports.RequestFunc.CREATEFILEMESSAGEBYURL,operationID:i,userID:n.uid,data:JSON.stringify(s)};n.wsSend(a,r,u)})},n.createFileMessageFromFullPath=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEFILEMESSAGEFROMFULLPATH,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createImageMessageFromFullPath=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEIMAGEMESSAGEFROMFULLPATH,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createSoundMessageFromFullPath=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATESOUNDMESSAGEFROMFULLPATH,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createVideoMessageFromFullPath=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEVIDEOMESSAGEFROMFULLPATH,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createMergerMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.messageList=JSON.stringify(e.messageList),s.summaryList=JSON.stringify(e.summaryList);var a={reqFuncName:exports.RequestFunc.CREATEMERGERMESSAGE,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.createForwardMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEFORWARDMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createFaceMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEFACEMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createLocationMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATELOCATIONMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createCustomMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATECUSTOMMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createQuoteMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATEQUOTEMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.createCardMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CREATECARDMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.sendMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.offlinePushInfo=s.offlinePushInfo?JSON.stringify(e.offlinePushInfo):"";var a={reqFuncName:exports.RequestFunc.SENDMESSAGE,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.sendMessageNotOss=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.offlinePushInfo=s.offlinePushInfo?JSON.stringify(e.offlinePushInfo):"";var a={reqFuncName:exports.RequestFunc.SENDMESSAGENOTOSS,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.getHistoryMessageList=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETHISTORYMESSAGELIST,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.revokeMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.REVOKEMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.setOneConversationPrivateChat=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SETONECONVERSATIONPRIVATECHAT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteMessageFromLocalStorage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DELETEMESSAGEFROMLOCALSTORAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteMessageFromLocalAndSvr=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DELETEMESSAGEFROMLOCALANDSVR,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteConversationFromLocalAndSvr=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DELETECONVERSATIONFROMLOCALANDSVR,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteAllMsgFromLocal=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.DELETEALLMSGFROMLOCAL,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.deleteAllMsgFromLocalAndSvr=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.DELETEALLMSGFROMLOCALANDSVR,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.markGroupMessageHasRead=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.MARKGROUPMESSAGEHASREAD,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.markGroupMessageAsRead=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.msgIDList=JSON.stringify(s.msgIDList);var a={reqFuncName:exports.RequestFunc.MARKGROUPMESSAGEASREAD,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.insertSingleMessageToLocalStorage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.INSERTSINGLEMESSAGETOLOCALSTORAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.insertGroupMessageToLocalStorage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.INSERTGROUPMESSAGETOLOCALSTORAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.typingStatusUpdate=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.TYPINGSTATUSUPDATE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.markC2CMessageAsRead=function(e,t){return new Promise(function(r,u){var i=e;i.msgIDList=JSON.stringify(i.msgIDList);var s=t||o(n.uid),a={reqFuncName:exports.RequestFunc.MARKC2CMESSAGEASREAD,operationID:s,userID:n.uid,data:i};n.wsSend(a,r,u)})},n.markMessageAsReadByConID=function(e,t){return new Promise(function(r,u){var i=e;i.msgIDList=JSON.stringify(i.msgIDList);var s=t||o(n.uid),a={reqFuncName:exports.RequestFunc.MARKMESSAGEASREADBYCONID,operationID:s,userID:n.uid,data:i};n.wsSend(a,r,u)})},n.clearC2CHistoryMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CLEARC2CHISTORYMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.clearGroupHistoryMessage=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CLEARGROUPHISTORYMESSAGE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getAllConversationList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETALLCONVERSATIONLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getConversationListSplit=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETCONVERSATIONLISTSPLIT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getOneConversation=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETONECONVERSATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getConversationIDBySessionType=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETCONVERSATIONIDBYSESSIONTYPE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getMultipleConversation=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETMULTIPLECONVERSATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteConversation=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DELETECONVERSATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.setConversationDraft=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SETCONVERSATIONDRAFT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.pinConversation=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.PINCONVERSATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getTotalUnreadMsgCount=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETTOTALUNREADMSGCOUNT,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getConversationRecvMessageOpt=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETCONVERSATIONRECVMESSAGEOPT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.setConversationRecvMessageOpt=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.conversationIDList=JSON.stringify(e.conversationIDList);var a={reqFuncName:exports.RequestFunc.SETCONVERSATIONRECVMESSAGEOPT,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.searchLocalMessages=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SEARCHLOCALMESSAGES,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.addFriend=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.ADDFRIEND,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getDesignatedFriendsInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETDESIGNATEDFRIENDSINFO,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getRecvFriendApplicationList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETRECVFRIENDAPPLICATIONLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getSendFriendApplicationList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETSENDFRIENDAPPLICATIONLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getFriendList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETFRIENDLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.setFriendRemark=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SETFRIENDREMARK,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.checkFriend=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CHECKFRIEND,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.acceptFriendApplication=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.ACCEPTFRIENDAPPLICATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.refuseFriendApplication=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.REFUSEFRIENDAPPLICATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.deleteFriend=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DELETEFRIEND,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.addBlack=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.ADDBLACK,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.removeBlack=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.REMOVEBLACK,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getBlackList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETBLACKLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.inviteUserToGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.userIDList=JSON.stringify(s.userIDList);var a={reqFuncName:exports.RequestFunc.INVITEUSERTOGROUP,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.kickGroupMember=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.userIDList=JSON.stringify(s.userIDList);var a={reqFuncName:exports.RequestFunc.KICKGROUPMEMBER,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.getGroupMembersInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.userIDList=JSON.stringify(s.userIDList);var a={reqFuncName:exports.RequestFunc.GETGROUPMEMBERSINFO,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.getGroupMemberList=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETGROUPMEMBERLIST,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getJoinedGroupList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETJOINEDGROUPLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.createGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.groupBaseInfo=JSON.stringify(s.groupBaseInfo),s.memberList=JSON.stringify(s.memberList);var a={reqFuncName:exports.RequestFunc.CREATEGROUP,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.setGroupInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s=e;s.groupInfo=JSON.stringify(s.groupInfo);var a={reqFuncName:exports.RequestFunc.SETGROUPINFO,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.getGroupsInfo=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.GETGROUPSINFO,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.joinGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.JOINGROUP,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.quitGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.QUITGROUP,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.dismissGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.DISMISSGROUP,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.changeGroupMute=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CHANGEGROUPMUTE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.changeGroupMemberMute=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.CHANGEGROUPMEMBERMUTE,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.transferGroupOwner=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.TRANSFERGROUPOWNER,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.getSendGroupApplicationList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETSENDGROUPAPPLICATIONLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.getRecvGroupApplicationList=function(e){return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.GETRECVGROUPAPPLICATIONLIST,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},n.acceptGroupApplication=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.ACCEPTGROUPAPPLICATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.refuseGroupApplication=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.REFUSEGROUPAPPLICATION,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.signalingInvite=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={};s.invitation=e;var a={reqFuncName:exports.RequestFunc.SIGNALINGINVITE,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.signalingInviteInGroup=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={};s.invitation=e;var a={reqFuncName:exports.RequestFunc.SIGNALINGINVITEINGROUP,operationID:i,userID:n.uid,data:s};n.wsSend(a,r,u)})},n.signalingAccept=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SIGNALINGACCEPT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.signalingReject=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SIGNALINGREJECT,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.signalingCancel=function(e,t){return new Promise(function(r,u){var i=t||o(n.uid),s={reqFuncName:exports.RequestFunc.SIGNALINGCANCEL,operationID:i,userID:n.uid,data:e};n.wsSend(s,r,u)})},n.wsSend=function(e,t,r){void 0===n.ws&&r({event:e.reqFuncName,errCode:112,errMsg:"ws conect failed...",data:"",operationID:e.operationID||""}),"object"==typeof e.data&&(e.data=JSON.stringify(e.data));var u={oid:e.operationID||o(n.uid),mname:e.reqFuncName,mrsve:t,mrjet:r,flag:!1};n.ws2promise[u.oid]=u;var i=function(t){var r=JSON.parse(t.data);if(exports.CbEvents[r.event.toUpperCase()])n.emit(r.event,r);else{e.reqFuncName===exports.RequestFunc.LOGOUT&&(n.logoutFlag=!0,n.ws.close(),n.ws=void 0);var o=n.ws2promise[r.operationID];o&&(0===r.errCode?o.mrsve(r):o.mrjet(r),delete n.ws2promise[r.operationID])}};"web"==n.platform?(n.ws.send(JSON.stringify(e)),n.ws.onmessage=i):(n.ws.send({data:JSON.stringify(e),success:function(e){"uni"===n.platform&&void 0!==n.ws._callbacks&&void 0!==n.ws._callbacks.message&&(n.ws._callbacks.message=[])}}),n.onceFlag&&(n.ws.onMessage(i),n.onceFlag=!1)),e.reqFuncName===exports.RequestFunc.LOGOUT&&(n.onceFlag=!0)},n.getPlatform(),n}t=e,(n=u).prototype=Object.create(t.prototype),n.prototype.constructor=n,r(n,t);var i=u.prototype;return i.login=function(e){var n=this;return new Promise(function(t,r){var o=e.userID,u=e.token,i=e.operationID;n.wsUrl=e.url+"?sendID="+o+"&token="+u+"&platformID="+e.platformID;var s={userID:o,token:u},a={event:exports.RequestFunc.LOGIN,errCode:0,errMsg:"",data:"",operationID:i||""};n.createWs(function(){n.uid=o,n.token=u,n.iLogin(s,i).then(function(e){n.logoutFlag=!1,t(e)}).catch(function(e){a.errCode=e.errCode,a.errMsg=e.errMsg,r(a)})},function(){a.errCode=111,a.errMsg="ws connect close...",n.logoutFlag||n.reconnect(),r(a)},function(e){console.log(e),a.errCode=112,a.errMsg="ws connect error...",r(a)}),n.ws||(a.errCode=112,a.errMsg="The current platform is not supported...",r(a))})},i.iLogin=function(e,n){var t=this;return new Promise(function(r,u){var i=n||o(t.uid),s={reqFuncName:exports.RequestFunc.LOGIN,operationID:i,userID:t.uid,data:e};t.wsSend(s,r,u)})},i.logout=function(e){var n=this;return new Promise(function(t,r){var u=e||o(n.uid),i={reqFuncName:exports.RequestFunc.LOGOUT,operationID:u,userID:n.uid,data:""};n.wsSend(i,t,r)})},i.getPlatform=function(){var e=typeof WebSocket,n=typeof uni,t=typeof wx;this.platform="undefined"===e?"object"===n&&"object"!==t?"uni":"object"!==n&&"object"===t?"wx":"unknow":"web"},i.createWs=function(e,n,t){var r=this;console.log("call createWs:::");var o=function(){r.iLogin({userID:r.uid,token:r.token}).then(function(e){return r.logoutFlag=!1})};e&&(o=e);var u=function(){console.log("ws close agin:::"),r.logoutFlag||r.reconnect()};n&&(u=n);var i=function(){};if(t&&(i=t),"web"===this.platform)return this.ws=new WebSocket(this.wsUrl),this.ws.onclose=u,this.ws.onopen=o,void(this.ws.onerror=i);var s="uni"===this.platform?uni:wx;this.ws=s.connectSocket({url:this.wsUrl,complete:function(){}}),this.ws.onClose(u),this.ws.onOpen(o),this.ws.onError(i)},i.reconnect=function(){var e=this;this.onceFlag||(this.onceFlag=!0),this.lock||(this.lock=!0,setTimeout(function(){e.createWs(),e.lock=!1},2e3))},u}(t),exports.emitter=t,exports.uuid=o;
//# sourceMappingURL=index.js.map
